<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDDAuto</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        .header {
            background-color: #333;
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 40px;
            margin: 0;
            font-weight: bold;
            letter-spacing: 1px;
        }

        /* Moderní tlačítko pro přihlášení */
        .login-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #007bff;
            color: white;
            padding: 14px 18px;
            font-size: 24px;
            font-weight: 600;
            text-decoration: none;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn i {
            font-size: 24px;
        }

        .login-btn:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.4);
        }

        .login-btn:active {
            background-color: #004085;
            transform: translateY(0);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        }

        /* Vyhledávací panel */
        .search-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 10px;
        }

        .search-container input {
            padding: 12px 15px;
            font-size: 16px;
            border-radius: 5px;
            border: 2px solid #ccc;
            width: 300px;
            transition: border-color 0.3s ease;
        }

        .search-container input:focus {
            border-color: #4CAF50;
            outline: none;
        }

        .search-container button {
            padding: 12px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .search-container button:hover {
            background-color: #45a049;
        }

        .search-container button:active {
            background-color: #388e3c;
        }

        /* Moderní tlačítko pro seřazení podle ceny */
        .sort-button {
            padding: 12px 20px;
            font-size: 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .sort-button:hover {
            background-color: #0056b3;
        }

        .sort-button:active {
            background-color: #004085;
        }

        /* Seznam vozidel */
        .vehicle-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding: 20px;
            margin: 0 auto;
            width: 90%;
        }

        @media (max-width: 1200px) {
            .vehicle-list {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 900px) {
            .vehicle-list {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .vehicle-list {
                grid-template-columns: 1fr;
            }
        }

        /* Vozidla */
        .vehicle-item {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
        }

        .vehicle-item:hover {
            transform: scale(1.05);
        }

        .vehicle-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 2px solid #eee;
        }

        /* Detaily vozidla */
        .vehicle-item-details {
            padding: 15px;
            text-align: center;
        }

        .vehicle-item-details h3 {
            font-size: 20px;
            margin: 10px 0;
            font-weight: bold;
        }

        .vehicle-item-details p {
            font-size: 14px;
            color: #666;
            margin: 5px 0;
        }

        .vehicle-item-details .price {
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0;
            color: #4CAF50;
        }

        .vehicle-item-details .modifications {
            font-style: italic;
            color: #888;
            margin-bottom: 15px;
        }

        /* Moderní tlačítko */
        .vehicle-item button {
            background-color: #ffa500;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 10px;
        }

        .vehicle-item button:hover {
            background-color: #ff7f00;
        }

        .vehicle-item button:focus {
            outline: none;
        }

/* Zajištění správného z-indexu pro modal okno */
.modal {
    display: none;
    position: fixed;
    z-index: 9999; /* Zvyšujeme z-index pro správné překrytí */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    padding-top: 60px;
    overflow: auto;
}

/* Zmenšení modálního okna */
.modal-content {
    background-color: #fff;
    margin: auto;
    padding: 20px;
    width: 100%; /* Změníme šířku modálního okna */
    max-width: 500px; /* Nastavíme maximální šířku */
    max-height: 100%; /* Omezíme výšku modálního okna */
    overflow-y: auto; /* Pokud je obsah vyšší než okno, povolíme rolování */
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

/* Moderní rámeček pro informace */
.modal-details, .modal-contact {
    background-color: #f9f9f9;
    padding: 20px;
    margin-top: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

/* Zarovnání textu do středu */
.modal-details h2, .modal-contact h2 {
    text-align: center;
    font-size: 24px;
    color: #333;
}

/* Styling pro text v rámečku */
.modal-details p, .modal-contact p {
    font-size: 16px;
    color: #555;
    line-height: 1.6;
    text-align: center;
}

/* Pro lepší kontrast pro kontaktní informace */
.modal-contact {
    background-color: #f1f1f1;
}

.modal img {
    width: 100%;
    max-width: 400px; /* Omezíme šířku obrázku */
    height: auto;
    object-fit: contain;
    margin: 0 auto;
    display: block;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}


.vehicle-info,
.contact-info {
    width: 48%;
}

.vehicle-info h2 {
    font-size: 22px;
    color: #333;
    margin-bottom: 10px;
}

.vehicle-info p {
    font-size: 16px;
    color: #666;
}

.contact-info h3 {
    font-size: 18px;
    color: #4CAF50;
}

.contact-info p {
    font-size: 16px;
    color: #666;
}

.close {
    color: #aaa;
    font-size: 30px;
    font-weight: bold;
    cursor: pointer;
}

.close:hover,
.close:focus {
    color: #333;
    text-decoration: none;
}


    </style>
</head>
<body>

    <div class="header">
        <h1>DDDAuto</h1>
        <a href="vehicles.html" class="login-btn">
            <i class="fas fa-user-shield"></i> <!-- Ikona pro administrátora -->
        </a>
    </div>

    <!-- Vyhledávací panel -->
    <div class="search-container">
        <input type="text" id="search-input" placeholder="Hledat podle názvu...">
        <input type="number" id="min-vin" placeholder="Min VIN">
        <input type="number" id="max-vin" placeholder="Max VIN">
        <button onclick="filterVehicles()">Hledat</button>
        <button class="sort-button" onclick="sortVehiclesByPrice()">Seřadit podle ceny</button>
    </div>

    <div class="vehicle-list" id="vehicle-list">
        <!-- Seznam vozidel se načte sem -->
    </div>
<div id="vehicle-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <img id="modal-image" src="" alt="Detail fotografie">

        <div class="modal-details">
            <h2 id="vehicle-name"></h2>
            <p id="vehicle-price"></p>
            <p id="vehicle-modifications"></p>
        </div>

        <div class="modal-contact">
            <h2>Kontakt na prodejce:</h2>
            <p id="vehicle-phone">Telefon: Není k dispozici</p>
            <p id="vehicle-email">Post: Není k dispozici</p>
        </div>
    </div>
</div>



    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>

    <script>
        // Inicializace Firebase na začátku
        const firebaseConfig = {
            apiKey: "AIzaSyA5HS8DAx-agVLBrsfVPiv5i1oKzwzvUTE",
            authDomain: "bazar-39aac.firebaseapp.com",
            projectId: "bazar-39aac",
            storageBucket: "bazar-39aac.firebasestorage.app",
            messagingSenderId: "960204577980",
            appId: "1:960204577980:web:12f4ca5eb7563fa71204b9",
            measurementId: "G-H2DW7KXGL4"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        } else {
            firebase.app(); 
        }

        const db = firebase.firestore();

        // Funkce pro načítání seznamu vozidel z Firestore
        function loadVehicleList() {
            const vehiclesContainer = document.getElementById("vehicle-list");

            db.collection("vehicles").get().then((querySnapshot) => {
                vehiclesContainer.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const vehicle = doc.data();
                    const vehicleDiv = document.createElement("div");
                    vehicleDiv.classList.add("vehicle-item");
                    vehicleDiv.innerHTML = `
                        <img src="${vehicle.photoURL || 'https://via.placeholder.com/300x200?text=No+Image'}" alt="Vozidlo">
                        <div class="vehicle-item-details">
                            <h3>${vehicle.name}</h3>
                            <p>VIN: ${vehicle.vin}</p>
                            <p class="modifications">Úpravy: ${vehicle.modifications || "Žádné úpravy"}</p>
                            <p class="price">${vehicle.price} Kč</p>
                            <button onclick="viewDetails('${doc.id}')">Zobrazit detaily</button>
                        </div>
                    `;
                    vehiclesContainer.appendChild(vehicleDiv);
                });
            }).catch((error) => {
                console.error("Chyba při načítání vozidel:", error);
            });
        }

// Funkce pro formátování ceny
function formatPrice(price) {
    return price.toLocaleString('cs-CZ') + ' Kč';
}
function viewDetails(vehicleId) {
    const modal = document.getElementById("vehicle-modal");
    const modalImage = document.getElementById("modal-image");
    const vehicleName = document.getElementById("vehicle-name");
    const vehiclePrice = document.getElementById("vehicle-price");
    const vehicleModifications = document.getElementById("vehicle-modifications");
    const vehiclePhone = document.getElementById("vehicle-phone");
    const vehicleEmail = document.getElementById("vehicle-email");

    const vehicleRef = db.collection("vehicles").doc(vehicleId);
    vehicleRef.get().then((doc) => {
        if (doc.exists) {
            const vehicle = doc.data();
            modal.style.display = "block";  // Zobrazí modální okno
            vehicleName.textContent = vehicle.name;

            // Použijeme secondPhotoURL, pokud je k dispozici, jinak použijeme photoURL
            const photoURL = vehicle.secondPhotoURL || vehicle.photoURL;
            modalImage.src = photoURL || 'https://via.placeholder.com/600x400?text=No+Image';

            // Použití formátování ceny s tečkami
            const formattedPrice = formatPrice(vehicle.price); 
            vehiclePrice.textContent = `Cena: ${formattedPrice}`;

            vehicleModifications.textContent = `Úpravy: ${vehicle.modifications || "Žádné úpravy"}`;
            vehiclePhone.textContent = `Telefon: ${vehicle.contactPhone || "338-831"}`;
            vehicleEmail.textContent = `Post: ${vehicle.contactEmail || "steve.duck@post.ic"}`;
        }
    });
}





        // Funkce pro zavření modálního okna
        const closeModal = document.getElementsByClassName("close")[0];
        closeModal.onclick = function() {
            const modal = document.getElementById("vehicle-modal");
            modal.style.display = "none";  // Zavře modální okno
        }

        // Zavření modálního okna, pokud klikneš mimo něj
        window.onclick = function(event) {
            const modal = document.getElementById("vehicle-modal");
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        // Funkce pro seřazení vozidel podle ceny
        function sortVehiclesByPrice() {
            const vehiclesContainer = document.getElementById('vehicle-list');

            db.collection("vehicles").orderBy("price", "asc").get().then((querySnapshot) => {
                vehiclesContainer.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const vehicle = doc.data();
                    const vehicleDiv = document.createElement("div");
                    vehicleDiv.classList.add("vehicle-item");
                    vehicleDiv.innerHTML = `
                        <img src="${vehicle.photoURL || 'https://via.placeholder.com/300x200?text=No+Image'}" alt="Vozidlo">
                        <div class="vehicle-item-details">
                            <h3>${vehicle.name}</h3>
                            <p>VIN: ${vehicle.vin}</p>
                            <p class="modifications">Úpravy: ${vehicle.modifications || "Žádné úpravy"}</p>
                            <p class="price">${vehicle.price} CZK</p>
                            <button onclick="viewDetails('${doc.id}')">Zobrazit detaily</button>
                        </div>
                    `;
                    vehiclesContainer.appendChild(vehicleDiv);
                });
            }).catch((error) => {
                console.error("Chyba při načítání vozidel:", error);
            });
        }

        // Funkce pro filtrování vozidel
        function filterVehicles() {
            const searchInput = document.getElementById("search-input").value.toLowerCase();
            const minVin = parseInt(document.getElementById("min-vin").value, 10);
            const maxVin = parseInt(document.getElementById("max-vin").value, 10);

            const vehiclesContainer = document.getElementById("vehicle-list");

            db.collection("vehicles").get().then((querySnapshot) => {
                vehiclesContainer.innerHTML = ''; // Vyčistí seznam před přidáním nových výsledků
                querySnapshot.forEach((doc) => {
                    const vehicle = doc.data();

                    // Kontrola, zda název obsahuje vyhledávací text a zda VIN spadá do rozsahu
                    if (vehicle.name.toLowerCase().includes(searchInput) &&
                        (isNaN(minVin) || vehicle.vin >= minVin) &&
                        (isNaN(maxVin) || vehicle.vin <= maxVin)) {

                        const vehicleDiv = document.createElement("div");
                        vehicleDiv.classList.add("vehicle-item");
                        vehicleDiv.innerHTML = `
                            <img src="${vehicle.photoURL || 'https://via.placeholder.com/300x200?text=No+Image'}" alt="Vozidlo">
                            <div class="vehicle-item-details">
                                <h3>${vehicle.name}</h3>
                                <p>VIN: ${vehicle.vin}</p>
                                <p class="modifications">Úpravy: ${vehicle.modifications || "Žádné úpravy"}</p>
                                <p class="price">${vehicle.price} CZK</p>
                                <button onclick="viewDetails('${doc.id}')">Zobrazit detaily</button>
                            </div>
                        `;
                        vehiclesContainer.appendChild(vehicleDiv);
                    }
                });
            }).catch((error) => {
                console.error("Chyba při filtrování vozidel:", error);
            });
        }

        // Načítání seznamu vozidel při načtení stránky
        loadVehicleList();
    </script>

</body>
    <!-- Copyright Footer -->
<div class="footer">
    <p>&copy; 2025 Blaze [438]. Všechna práva vyhrazena. </p>
</div>

<style>
    .footer {
        background-color: #333;
        color: white;
        padding: 20px 0;
        text-align: center;
        font-size: 14px;
        position: relative;
        bottom: 0;
        width: 100%;
    }

    .footer p {
        margin: 5px 0;
    }

    .footer a {
        color: #4CAF50;
        font-weight: bold;
    }

    .footer a:hover {
        text-decoration: underline;
    }
</style>

</html>
